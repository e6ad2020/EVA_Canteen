#!/bin/bash

# ๐๏ธ ุฅุนุฏุงุฏุงุช ุงููุดุฑูุน
REPO_PATH="/home/eyad/EVA_Canteen"  # ูุณุงุฑ ุงููุณุชูุฏุน
BRANCH="main"                       # ุงุณู ุงููุฑุน ุงูุฑุฆูุณู

# ๐งญ ุงูุงูุชูุงู ุฅูู ูุฌูุฏ ุงููุดุฑูุน
cd "$REPO_PATH" || { echo "โ ูุดู ุงูุฏุฎูู ุฅูู ุงููุฌูุฏ $REPO_PATH"; exit 1; }

# โ ุงูุชุฃูุฏ ูู ูุฌูุฏ ุชุบููุฑุงุช ุบูุฑ ูุฑููุนุฉ
if [[ -n $(git status --porcelain) ]]; then
    echo "๐ ุชู ุงูุชุดุงู ุชุบููุฑุงุช ุฌุฏูุฏุฉุ ุฌุงุฑู ุฑูุนูุง..."

    # โ ุฅุถุงูุฉ ูู ุงููููุงุช
    git add .

    # ๐ ุฅูุดุงุก Commit ุฌุฏูุฏ ุจุชุงุฑูุฎ ูููุช
    git commit -m "Auto commit: $(date +'%Y-%m-%d %H:%M:%S')"

    # ๐ ุงูุชุฃูุฏ ูู SSH Agent ุดุบุงู
    if ! pgrep -u "$USER" ssh-agent > /dev/null; then
        eval "$(ssh-agent -s)"
        ssh-add ~/.ssh/id_ed25519
    fi

    # ๐ ุฑูุน ุงูุชุบููุฑุงุช ุฅูู ุงููุฑุน ุงูุฑุฆูุณู
    git push origin "$BRANCH"

    echo "โ ุชู ุฑูุน ุงูุชุบููุฑุงุช ุจูุฌุงุญ!"
else
    echo "โ ูุง ุชูุฌุฏ ุชุบููุฑุงุช ูุฑูุนูุง."
fi

